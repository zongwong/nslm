<style lang="scss">
.index-banner{
  height: 388rpx;
  padding: 0 18rpx;
  swiper{
    height: 100%;
    width: 100%;
  }
}
.index-banner image{
  height: 100%;
  width: 100%;
}
.openDaka{
  width: 108rpx;
  height: 108rpx;
  position: fixed;
  bottom: 134rpx;
  right: 16rpx;
  z-index: 1;
}
//search
.searchbar{
    width:100%;
    height: 100rpx;
    background: #fff;
    padding: 20rpx 0;
    box-sizing: border-box;
    display: flex;
    justify-content: space-around;
    .searchbox{
        background:#f8f8f8;
        height: 60rpx;
        width:560rpx;
        border: 1px solid #f5f5f5;
        border-radius: 40rpx;
        margin-right: 16rpx;
        text-align: center;
        .search-icon{
            display: inline-block;
            vertical-align: middle;
            margin-right: 12rpx;
            width: 38rpx;
            height: 38rpx;
            background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjFGRUE5MDc1REMxNDExRTdBQjFGODdFODVFMDU1MDZCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjFGRUE5MDc2REMxNDExRTdBQjFGODdFODVFMDU1MDZCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MUZFQTkwNzNEQzE0MTFFN0FCMUY4N0U4NUUwNTUwNkIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MUZFQTkwNzREQzE0MTFFN0FCMUY4N0U4NUUwNTUwNkIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5N+cWoAAADbElEQVR42syYbWiNYRjHn3M2Y5ptaWxmSVgzeRuTJsMIoSFiKUYRzdskzMon4oNaJMUHzTT7gA9bKMLEzkKE2LIZ+TCMzUvm/WUv/lf9T93d9pw95+w853HVr/t6zjnPc/7P/XLd13W7SorLDD8sDGSALDAWDAcxIBx8B29BA7gFroHXRoAWbvF3g8FmkAsSffxuJJgB1oMOcBMcBRW8DpqwPmA32AUilc+bQTWoBy3gJ4gGSWAMezWSPSvUgk2gKhjCRoOzIJXX8ucl4BS4Y+GFskEehcmzboAjoAD86k6Y2+TzOeA2RXWC05xPeRZEeV/iHJgJpoHHwAXywRUQG4iw2eACiAKtYAlYBZoCnMcekA4O8VqEVnLRWBaWyjeNAG/4kAqj5/YHbAcbQDuYwP8JM13+ixctVeeFdPMQ9pQMQ40RXLsP3oEFnBrtXLk+e2wnV5TMqZU2iPLaMVBMfw9DjKmwBFBIX266aNhrsggaQS9Q5EtYPuPOV8Ytu039n3kgrSthMgHX8Po4eG+Exs6AZwwj67oSlsmhNJSxD4V1MGCLLdcjhFzMol9HQmnlbOPAOF1YOv0qI/RWx31XbJIuLIX+E8MZq2ebrAvrT7/JIWHenG2gLsy7Z/1wSNhntn11YV/oRzgkLIrtb13YJ/rxDgmLY/tBF9ZAP8UhYaPYvtCFPaKf6YCoJGYzYg90YZX001h0hNKylb3zni5MyqyP9HNDLGw120t6VHBzNZTyeqtWDdlpshVOpn/CLO0posAEVjF2m2Q0B+k/BFfNhL0Eh+lLnjTeZmEFzPs7mTl3+kqt94HnoDcLhQE2iVoI9tI/qSw+U2GyMnJ4BjECXLYh6MrzyjiUUmtusVq+SSxZoZRYHhuGtU2pM4b6U/CeB8tYTSezIi8M0l7azCq/ldnEdeUIwtIRQTnrykbWmweYn2/T0xMTkzx+okmPSCCdS3HxFPdPCefq5nwslotio/ISbTy/8HCfbWGo6QeGcQeRlxrEwB2vDJ9qGQysMaz65fDlqVVh6tHBDhYNUX4MXS3naLvJ91MoLpqJapY3qXD7kZuvZS/ksMy7q6UqHYyHMjT7wfRuRInJyeN85oSJvDfZnx6zcs7W1oP7p7LnZDReSc+5gxwCArVq9tw3pkKlbuP/MQ/FyUKo+SvAACs1vgre/sNkAAAAAElFTkSuQmCC) center / 100% no-repeat;
        }
        input{
            font-size:26rpx;
            display: inline-block;
            vertical-align: middle;
        }
    }
    .searchinfo{
        background:#f8f8f8 url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAiCAYAAACwaJKDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE5QjJDRjc4REMxNDExRTc4NUJFRDExNjU0OUUyQjJBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE5QjJDRjc5REMxNDExRTc4NUJFRDExNjU0OUUyQjJBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTlCMkNGNzZEQzE0MTFFNzg1QkVEMTE2NTQ5RTJCMkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MTlCMkNGNzdEQzE0MTFFNzg1QkVEMTE2NTQ5RTJCMkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5VIjDSAAAB40lEQVR42qyWyytEURzHryHEwkaUhWhEEUpJynPhMSnlsfBIFh4LC0pS/guvbDSDjEfJcyObwcJCKBkpk1esSGQpz++p762b7r2dcc+vPv3mzj3nM+f85p7fTMSsb0GziHzQBKpAKkgEz+ABHIB5cGo2McrkvQwwDjwm91JIERgE62AYXBkHuf5MEqIj5i9O6gQFIA3kgg6wAj5AAzgGdVYrrQdrIJLb6wUXJqs9B37uaBpUgE3QDDaMK80CixTOgUoLoTGuWO8ZzhMflGmUihrGg33Qxa3JxCfoAXucP6lLC0E1B/SxluGEGN/N+WLlhULaxpurElu2imu9nohWIS3jxZbmLPT55ULq5sWlQ2mQ2e1iXUVdbh1KX5kToljcWPDiUJrE/CKkh5qayGO+cWnqopE5oEqaA2r42q9CGg28PKqiBwSdSsUXvMxW+Ab6zVpfOFECTtj+3lnT+/9KY8AEm082eGT/Ddh1fruIA9s82j/AB4YMD/6/pF4KhaQV7Mj+RllFLWhhr/XYHZpwajpiaOi2p1BWmgxKwbfe3VVIi0EECIE7VVK9557JDJaVJuptTaX0iTkkM1j2kRoDu7Lbl5V+W/0Zc/qcaqql6WCUWZm0HQwwK6vpFJvIkszgXwEGAKKTYPiCsJZsAAAAAElFTkSuQmCC) center no-repeat;
        background-size: 21rpx 34rpx;
        height: 60rpx;
        width: 60rpx;
        border: 1px solid #f5f5f5;
        border-radius: 50%;
    }
}
.tabNav{
    margin: 22rpx 0;
}
</style>
<template>
  <view>
    <view class="searchbar">
      <view class="searchbox">
          <text class="search-icon"></text>
          <input placeholder="输入PK码赢取好友奖金！" @confirm="searchConfirm" />
      </view>
      <view class="searchinfo" @tap="pkModal(1)"></view>       
    </view>
    <view class="index-banner">
      <swiper autoplay="true" indicator-dots="true" indicator-active-color="#fff">
        <block wx:for="{{3}}" wx:key="swiper_{{index}}">
          <navigator url="/pages/index/detail" hover-class="none">
            <swiper-item>
                <image src="{{imgs.banner}}" />
            </swiper-item>
          </navigator>
        </block>
      </swiper>
    </view> 
    <tabNav :navs="typeNavs"></tabNav>
    <!-- 列表 -->
    <repeat for="{{activeList}}" key="index" index="index" item="item">
        <activityList :item="item"></activityList>
    </repeat>
    <navigator url="/pages/index/start"><image class="openDaka" src="../../images/icon-dk.png"></image></navigator> 
    <explain :status.sync="status"></explain>
  </view>
</template>

<script>
import wepy from "wepy"
import interfaces from "../../interface/index"
import activityList from "../../components/index/activityList"
import tabNav from "../../components/index/tabNav"
import explain from "../../components/public/explain"
import http from "../../utils/request"
import api from "../../config"
export default class Index extends wepy.page {
  config = {
    navigationBarTitleText: "首页"
  };
  components = {
    tabNav:tabNav,
    activityList:activityList,
    explain:explain
  };

  data = {
    typeNavs:[
        {
            text:'按热度',
            selected:true,
        },{
            text:'按时间',
            selected:false,
        },{
            text:'按热度',
            selected:false,
        }
    ],
    tabIndex: 1,
    status:false,
    activeList: [],
    imgs: null
  };

  computed = {
    now() {
      return +new Date();
    }
  };

  methods = {
    // pk码说明
    pkModal() {
        this.status = true
    },
    // 搜索
    searchConfirm(event) {
      let value = event.detail.value;
      // async search(){}
      wx.navigateTo({
        url: '/pages/index/detail',
        success: function(res){
        },
      })
    },
  };

  events = {
    //tab事件
    'navTapEvent':(index) => {
      this.tabIndex = (index + 1)
      this.getActiveList(this.tabIndex)
    }
  };

  onLoad() {
    this.getActiveList(this.tabIndex)
    this.imgs = this.$parent.globalData.imgs
  }
  // 获取活动列表
  async getActiveList(sort) {
    // 1按热度2按时间3已结束
    const { data } = await http({
      method: api.activity.list.method,
      url: api.activity.list.url,
      data: {
        sort: sort
      }
    })
    if(data.code){
      this.activeList = data.info
      this.$apply()
    }
  }
}
</script>
